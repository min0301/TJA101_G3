<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>PixelTribe ç®¡ç†å“¡é¦–é </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;700&family=Press+Start+2P&display=swap"
          rel="stylesheet">

    <link rel="stylesheet" href="../../../assets/vendors/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="/assets/vendors/bootstrap/bootstrap.min.css">
<!--    <link rel="stylesheet" href="/assets/vendors/bootstrap-icons/bootstrap-icons.css">-->

    <style>

        body {
            width: 100vw;
            height: 100vh;
            /* ã€æ ¸å¿ƒä¿®æ”¹ã€‘å°‡ overflow-x: hidden æ”¹ç‚º overflow: hidden; */
            /* ç†ç”±ï¼šå¾¹åº•ç¦æ­¢ body å…ƒç´ ç”¢ç”Ÿä»»ä½•æ–¹å‘çš„æ»¾å‹•æ¢ï¼Œå°‡æ»¾å‹•æ§åˆ¶æ¬Šå®Œå…¨äº¤çµ¦å…§éƒ¨çš„ content-cardã€‚ */
            overflow: hidden;
        }

        /* --- æ ¸å¿ƒè®Šæ•¸: å…¨é¢æ›¿æ›ç‚ºå‰å°è–„è·ç¶ é¢¨æ ¼ --- */
        :root {
            --primary-bg: #f0f2f5;
            --component-bg: #ffffff;
            --border-color: #e0e0e0;
            --text-color: #5d5d66;
            --text-muted: #6c757d;
            --brand-green: #08beab;
            --brand-green-hover: #07a897;
            --brand-green-light: rgba(8, 190, 171, 0.1);
        }

        /* --- åŸºç¤æ¨£å¼: çµ±ä¸€å­—é«”èˆ‡èƒŒæ™¯ --- */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            min-height: 100vh;
            background: var(--primary-bg);
            font-family: 'Karla', 'å¾®è»Ÿæ­£é»‘é«”', Arial, sans-serif;
            box-sizing: border-box;
            color: var(--text-color);
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow-x: hidden;
        }

        /* --- é ‚éƒ¨å°è¦½åˆ— --- */
        .topbar {
            width: 100%;
            height: 60px;
            background: var(--component-bg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10;
            padding: 0 24px;
            box-sizing: border-box;
            border-bottom: 1px solid var(--border-color);
        }

        .topbar-logo img {
            height: 40px;
            width: auto;
            vertical-align: middle;
        }

        .logout-btn {
            background: var(--brand-green-light);
            color: var(--brand-green);
            border: 2px solid var(--brand-green);
            border-radius: 8px;
            padding: 8px 24px;
            font-family: 'Karla', sans-serif;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .logout-btn:hover {
            background: var(--brand-green);
            color: var(--component-bg);
        }

        /* --- ä¸»è¦ä½ˆå±€ --- */
        .main-wrap {
            display: flex;
            height: calc(100vh - 60px);
            min-height: 540px;
            margin-top: 60px;
        }

        /* --- å·¦å´é¸å–®æ¬„ --- */
        .sidebar-card {
            width: 280px;
            background: var(--component-bg);
            border-radius: 0;
            padding: 24px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
            border-right: 1px solid var(--border-color);
        }

        .sidebar-menu {
            width: 100%;
            list-style: none;
            padding: 0 12px;
            margin: 0;
        }

        .menu-item {
            width: 100%;
            margin-bottom: 8px;
        }

        .menu-button {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            margin: 0 auto;
            padding: 14px 20px;
            font-size: 16px;
            color: var(--text-color);
            background: none;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.15s, color 0.15s;
            outline: none;
            font-weight: 700;
            letter-spacing: 0.2px;
        }

        .menu-button:hover {
            background: var(--brand-green-light);
            color: var(--brand-green);
        }

        .menu-button.active {
            background: var(--brand-green);
            color: var(--component-bg);
        }

        .menu-button .icon {
            margin-right: 16px;
            font-size: 18px;
            vertical-align: -0.15em;
        }

        .menu-button .arrow {
            font-size: 14px;
            transition: transform 0.3s ease;
        }

        .menu-item.active .menu-button .arrow {
            transform: rotate(180deg);
        }

        .submenu {
            width: 93%;
            margin: 4px auto 0;
            background: var(--primary-bg);
            border-radius: 8px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, opacity 0.4s ease-out;
            opacity: 0;
        }

        .menu-item.active .submenu {
            max-height: 550px;
            opacity: 1;
        }

        .submenu-item {
            padding: 10px 18px 10px 48px;
            transition: all 0.13s ease;
            cursor: pointer;
            position: relative;
            font-size: 15px;
            color: var(--text-muted);
            font-weight: 500;
            display: block;
            text-decoration: none;
            border-bottom: 1px solid var(--border-color);
        }

        .submenu-item:last-child {
            border-bottom: none;
        }

        .submenu-item:hover {
            background: var(--brand-green-light);
            color: var(--brand-green);
        }

        .submenu-item.active {
            background: var(--brand-green-light);
            color: var(--brand-green);
            font-weight: 700;
        }

        .submenu-item .item-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: var(--brand-green);
        }

        /* --- å³å´å…§å®¹å€ --- */
        /* --- å³å´å…§å®¹å€ --- */
        .content-card {
            flex: 1;
            /* ã€æ ¸å¿ƒä¿®æ”¹ã€‘è®“å…§å®¹å€æœ¬èº«è®Šæˆç™½è‰²å¡ç‰‡ */
            background: var(--component-bg); /* æ”¹æˆç™½è‰² */
            border-radius: 12px; /* çµ¦å®ƒä¸€å€‹åœ“è§’ï¼Œæ›´å¥½çœ‹ */
            margin: 24px; /* ç”¨ margin ä»£æ›¿ paddingï¼Œè®“ç°è‰²èƒŒæ™¯éœ²å‡ºä¾† */
            padding: 24px; /* padding ç”¨ä¾†ç´„æŸå…§éƒ¨å…ƒç´ ï¼Œè€Œä¸æ˜¯è£½é€ å¤–éƒ¨é–“è· */

            /* ä»¥ä¸‹ä¸è®Š */
            min-width: 0;
            min-height: calc(100% - 48px); /* æ¸›å»ä¸Šä¸‹ margin */
            display: flex;
            /* ã€æ ¸å¿ƒä¿®æ”¹ã€‘ä¸å†éœ€è¦ justify-contentï¼Œå› ç‚ºå…§å®¹è¦å¡«æ»¿ */
            /* justify-content: center; */
            overflow-y: auto;
            box-sizing: border-box; /* ç¢ºä¿ padding å’Œ border ä¸æœƒæ’å¤§ç›’å­ */
        }

        .content-card {
            border-radius: 0;
            box-shadow: none;
        }

        .dashboard-content {
            width: 100%;
            max-width: 1100px;
            margin: 0 auto;
        }

        .welcome-section {
            width: 100%;
            margin-bottom: 40px;
            text-align: left;
        }

        .welcome-title {
            font-family: 'Karla', sans-serif;
            font-size: 28px;
            color: var(--text-color);
            font-weight: 700;
            margin-bottom: 10px;
            padding: 0;
            background: none;
            border-left: none;
            box-shadow: none;
        }

        .welcome-subtitle {
            font-size: 16px;
            color: var(--text-muted);
            margin: 0;
            max-width: none;
            text-align: left;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            width: 100%;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--component-bg);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.2s ease;
            border: 1px solid var(--border-color);
            min-height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }

        .stat-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--brand-green);
        }

        .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-muted);
        }

        .guide-text {
            width: 100%;
            background: var(--component-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 30px;
            margin-top: 20px;
        }

        .guide-text h3 {
            font-family: 'Karla', sans-serif;
            color: var(--text-color);
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 18px;
            letter-spacing: 0;
        }

        .guide-text p {
            font-size: 15px;
            line-height: 1.7;
            margin: 0;
            color: var(--text-muted);
        }

        .sys-block {
            width: 100%;
        }

        .sys-subtitle {
            font-family: 'Karla', sans-serif;
            font-size: 24px;
            color: var(--text-color);
            font-weight: 700;
            margin-bottom: 30px;
            letter-spacing: 0;
            padding: 0;
            background: none;
            border-left: none;
            box-shadow: none;
            display: block;
        }

        .sys-block ul {
            padding: 0;
            margin: 0;
            list-style: none;
            width: 100%;
        }

        .sys-block li {
            margin-bottom: 14px;
            font-size: 16px;
            padding: 15px 20px 15px 50px;
            border-radius: 8px;
            background: var(--component-bg);
            font-weight: 500;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            position: relative;
            transition: all 0.2s ease;
        }

        .sys-block li:hover {
            border-color: var(--brand-green);
            background: var(--brand-green-light);
        }

        .sys-block li .item-icon {
            position: absolute;
            left: 20px;
            font-size: 18px;
            color: var(--brand-green);
        }

        /* --- éŸ¿æ‡‰å¼è¨­è¨ˆ --- */
        @media (max-width: 1100px) {
            .main-wrap {
                flex-direction: column;
            }

            .sidebar-card, .content-card {
                border-radius: 0;
                width: 100%;
                border-right: none;
            }

            .content-card {
                padding: 30px 4vw;
                border-top: 1px solid var(--border-color);
            }

            .sidebar-card {
                padding: 12px 0;
                height: auto;
            }
        }

        @media (max-width: 650px) {
            .content-card {
                padding: 20px;
            }

            .topbar-logo img {
                height: 35px;
            }

            .logout-btn {
                padding: 6px 16px;
                font-size: 13px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
<div class="topbar">
    <a href="#" class="topbar-logo" onclick="loadMainDashboard(event)">
        <img src="../../../images/logo.png" alt="Pixel Tribe Logo">
    </a>
    <button class="logout-btn" onclick="handleLogout()">ç™»å‡º</button>
</div>
<div class="main-wrap">
    <nav class="sidebar-card">
        <ul class="sidebar-menu">
            <li class="menu-item" id="menu-store">
                <button class="menu-button" onclick="toggleMenu('store')">
                    <span><i class="bi bi-shop-window icon"></i>å•†åŸç³»çµ±</span>
                    <i class="bi bi-chevron-down arrow"></i>
                </button>
                <div class="submenu">
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'dashboard', event)">
                        <i class="bi bi-pie-chart-fill item-icon"></i>å„€è¡¨æ¿
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'management', event)">
                        <i class="bi bi-box-seam item-icon"></i>ç”¢å“ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'malltag', event)">
                        <i class="bi bi-tags-fill item-icon"></i>ç”¢å“åˆ†é¡
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'orders', event)">
                        <i class="bi bi-receipt-cutoff item-icon"></i>è¨‚å–®ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'shipping', event)">
                        <i class="bi bi-truck item-icon"></i>ç”¢å“ç™¼è²¨ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'reviews', event)">
                        <i class="bi bi-chat-square-text-fill item-icon"></i>è¨‚å–®è©•è«–ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('store', 'coupons', event)">
                        <i class="bi bi-ticket-perforated-fill item-icon"></i>å„ªæƒ åˆ¸ç®¡ç†
                    </a>
                </div>
            </li>
            <li class="menu-item" id="menu-news">
                <button class="menu-button" onclick="toggleMenu('news')">
                    <span><i class="bi bi-newspaper icon"></i>æ–°èç³»çµ±</span>
                    <i class="bi bi-chevron-down arrow"></i>
                </button>
                <div class="submenu">
                    <a href="#" class="submenu-item" onclick="renderContent('news', 'dashboard', event)">
                        <i class="bi bi-pie-chart-fill item-icon"></i>å„€è¡¨æ¿
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('news', 'categories', event)">
                        <i class="bi bi-pencil-fill item-icon"></i>æ–°èé¡åˆ¥ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('news', 'management', event)">
                        <i class="bi bi-pencil-fill item-icon"></i>æ–°èç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('news', 'comments', event)">
                        <i class="bi bi-chat-dots-fill item-icon"></i>æ–°èè©•è«–ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('news', 'reports', event)">
                        <i class="bi bi-shield-check item-icon"></i>æ–°èè©•è«–å¯©æ ¸æª¢èˆ‰
                    </a>
                </div>
            </li>
            <li class="menu-item" id="menu-forum">
                <button class="menu-button" onclick="toggleMenu('forum')">
                    <span><i class="bi bi-chat-square-dots-fill icon"></i>è«–å£‡ç³»çµ±</span>
                    <i class="bi bi-chevron-down arrow"></i>
                </button>
                <div class="submenu">
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'dashboard', event)">
                        <i class="bi bi-pie-chart-fill item-icon"></i>å„€è¡¨æ¿
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'categories', event)">
                        <i class="bi bi-tags-fill item-icon"></i>è¨è«–å€é¡åˆ¥ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'forums', event)">
                        <i class="bi bi-card-list item-icon"></i>è¨è«–å€ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'posts', event)">
                        <i class="bi bi-file-text-fill item-icon"></i>æ–‡ç« ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'comments', event)">
                        <i class="bi bi-chat-left-text-fill item-icon"></i>ç•™è¨€ç®¡ç†
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'official', event)">
                        <i class="bi bi-megaphone-fill item-icon"></i>ç™¼å¸ƒå®˜æ–¹æ–‡ç« 
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('forum', 'reports', event)">
                        <i class="bi bi-shield-check item-icon"></i>æ–‡ç« ç•™è¨€æª¢èˆ‰å¯©æ ¸
                    </a>
                </div>
            </li>
            <li class="menu-item" id="menu-member">
                <button class="menu-button" onclick="toggleMenu('member')">
                    <span><i class="bi bi-people-fill icon"></i>æœƒå“¡ç³»çµ±</span>
                    <i class="bi bi-chevron-down arrow"></i>
                </button>
                <div class="submenu">
                    <a href="#" class="submenu-item" onclick="renderContent('member', 'dashboard', event)">
                        <i class="bi bi-pie-chart-fill item-icon"></i>å„€è¡¨æ¿
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('member', 'query', event)">
                        <i class="bi bi-person-lines-fill item-icon"></i>æœƒå“¡è³‡æ–™æŸ¥è©¢
                    </a>
                    <a href="#" class="submenu-item" onclick="renderContent('member', 'suspend', event)">
                        <i class="bi bi-person-slash item-icon"></i>æœƒå“¡åœæ¬Š
                    </a>
                </div>
            </li>
        </ul>
    </nav>
    <main class="content-card" id="content-area">
    </main>
</div>

<script>
    // ã€å¸¸æ•¸ã€‘å°‡å…§å®¹å€åŸŸçš„ DOM ç‰©ä»¶æå‡ºä¾†ï¼Œé¿å…é‡è¤‡é¸å–
    const contentArea = document.getElementById('content-area');


    // =================================================================================
    // ã€æ ¸å¿ƒä¿®æ”¹ã€‘é é¢è·¯ç”±è¨­å®šï¼šæœªä¾†æ–°å¢é é¢ï¼Œåªéœ€åœ¨æ­¤è™•å¢åŠ ä¸€è¡Œå°æ‡‰
    // æ ¼å¼ï¼š'ä¸»é¸å–®Key-å­é¸å–®Key': 'å°æ‡‰çš„ HTML æª”æ¡ˆè·¯å¾‘'
    // =================================================================================
    const pageMappings = {
    	'store-management':'../shopsys/product/listAllProduct.html',
    	'store-malltag':'../shopsys/malltag/listAllMallTag.html',
        'store-orders': '../shopsys/order/allOrder.html',
        'forum-forums': '../forumsys/forum/allForum.html',
        'forum-add': '../forumsys/forum/addForum.html',
        'forum': '../forumsys/forum/forum.html',
        'forum-categories': '../forumsys/category/allCategory.html',
        'forum-add-category': '../forumsys/category/addCategory.html',
        'forum-edit-category': '../forumsys/category/editCategory.html',
        'forum-comments': '../forumsys/message/allMessages.html',
        'forum-reports': '../forumsys/messagereport/allReports.html',
        'news-management':'../newssys/news/listAllNews.html',
        'news-categories': '../newssys/category/allNewsCategory.html',
        'news-add-category': '../newssys/category/addNewsCategory.html',
        'news-edit-category': '../newssys/category/editNewsCategory.html',
        'news-comments': '../newssys/comments/allNewsComment.html',
        'news-edit-comments': '../newssys/comments/editNewsComment.html',

        // åœ¨æ­¤è™•ç¹¼çºŒæ·»åŠ å…¶ä»–é é¢...
        // 'member-query': '../membersys/query/allMember.html',
    };


    function toggleMenu(menuKey) {
        const menuItem = document.getElementById('menu-' + menuKey);
        if (!menuItem) return;

        if (!menuItem.classList.contains('active')) {
            document.querySelectorAll('.menu-item.active').forEach(item => {
                item.classList.remove('active');
            });
        }
        menuItem.classList.toggle('active');
    }

    /**
     * ã€æ ¸å¿ƒä¿®æ”¹ã€‘æ ¹æ“š key æ±ºå®šæ¸²æŸ“å…§éƒ¨ HTML é‚„æ˜¯è¼‰å…¥å¤–éƒ¨é é¢
     * @param {string} pageKey - ä¸»é¸å–® key (ä¾‹å¦‚ 'store')
     * @param {string} subKey - å­é¸å–® key (ä¾‹å¦‚ 'orders')
     * @param {Event} event - é»æ“Šäº‹ä»¶ç‰©ä»¶
     */
    function renderContent(pageKey, subKey, event) {
        event.preventDefault();

        document.querySelectorAll('.submenu-item.active').forEach(item => item.classList.remove('active'));
        event.currentTarget.classList.add('active');

        // [ä¸å¯è®Š] çµ„åˆ keyï¼Œç”¨æ–¼æŸ¥è©¢ pageMappings
        const mappingKey = `${pageKey}-${subKey}`;
        const targetPath = pageMappings[mappingKey];

        // å¦‚æœåœ¨ pageMappings ä¸­æ‰¾åˆ°å°æ‡‰è·¯å¾‘ï¼Œå‰‡è¼‰å…¥å¤–éƒ¨æª”æ¡ˆ
        if (targetPath) {
            loadExternalPage(targetPath);
        } else if (pageKey === 'store' && subKey === 'dashboard') {
            // å°æ–¼åŸæœ¬å…§å»ºçš„å„€è¡¨æ¿ï¼Œä¿ç•™åŸé‚è¼¯
            contentArea.innerHTML = getShopDashboardHTML();
        } else {
            // å…¶ä»–æ‰€æœ‰æœªè¨­å®šçš„é é¢ï¼Œé¡¯ç¤ºä½”ä½å…§å®¹
            contentArea.innerHTML = getPlaceholderHTML(pageKey, subKey);
        }
    }

    /**
     * ã€æ ¸å¿ƒä¿®æ­£ã€‘é€šç”¨å¤–éƒ¨é é¢è¼‰å…¥å™¨ (æ•´åˆç‰ˆ)
     * @param {string} url - è¦è¼‰å…¥çš„ HTML æª”æ¡ˆè·¯å¾‘ (å¯åŒ…å«æŸ¥è©¢åƒæ•¸)
     */
    async function loadExternalPage(url) {
        try {
            // --- å»é‡ï¼šåŒä¸€é å°±ä¸å† reload ---
            if (contentArea.dataset.current === url) return;
            contentArea.dataset.current = url;

            contentArea.innerHTML = `<div class="sys-block" style="text-align: center; font-size: 20px;">è¼‰å…¥ä¸­...</div>`;

            // [ä¸å¯è®Š] é€™æ˜¯ä¿®æ­£çš„æ ¸å¿ƒï¼šå»ºç«‹ä¸€å€‹å®Œæ•´çš„ URL ç‰©ä»¶ä¾†è§£æå‚³å…¥çš„ç›¸å°è·¯å¾‘èˆ‡åƒæ•¸ã€‚
            // window.location.href ä½œç‚ºç¬¬äºŒå€‹åƒæ•¸ï¼Œå¯ä»¥ç¢ºä¿ç›¸å°è·¯å¾‘ (å¦‚ ../...) è¢«æ­£ç¢ºè§£æã€‚
            const fullUrl = new URL(url, window.location.href);

            // [ä¸å¯è®Š] å°‡è§£æå‡ºçš„æŸ¥è©¢å­—ä¸² (ä¾‹å¦‚ "?id=1") å­˜åˆ° content-area çš„ data-page-params å±¬æ€§ä¸­ã€‚
            // é€™æ˜¯ç‚ºäº†è®“å­é é¢çš„è…³æœ¬å¯ä»¥è®€å–åˆ°é€™å€‹å€¼ã€‚
            contentArea.setAttribute('data-page-params', fullUrl.search);

            const response = await fetch(fullUrl);
            if (!response.ok) {
                throw new Error(`ç„¡æ³•è¼‰å…¥é é¢: ${response.status} ${response.statusText}`);
            }
            const pageText = await response.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(pageText, 'text/html');

            const styles = doc.querySelectorAll('style');
            const scripts = doc.querySelectorAll('script');
            const pageContent = doc.querySelector('[class*="-container"], [class*="-wrapper"]');

            if (!pageContent) {
                throw new Error("åœ¨è¼‰å…¥çš„é é¢ä¸­æ‰¾ä¸åˆ°ä¸»è¦çš„å…§å®¹å®¹å™¨ã€‚");
            }

            contentArea.innerHTML = ''; // æ¸…ç©º
            contentArea.appendChild(pageContent);

            // æ¸…ç†èˆŠçš„å‹•æ…‹æ¨£å¼å’Œè…³æœ¬
            document.querySelectorAll('[data-dynamic-style], [data-dynamic-script]').forEach(el => el.remove());

            // è¼‰å…¥æ–°çš„æ¨£å¼
            styles.forEach(style => {
                const newStyle = document.createElement('style');
                newStyle.setAttribute('data-dynamic-style', 'true');
                newStyle.textContent = style.textContent;
                document.head.appendChild(newStyle);
            });

            // è¼‰å…¥ä¸¦åŸ·è¡Œæ–°çš„è…³æœ¬
            scripts.forEach(script => {
                const newScript = document.createElement('script');
                newScript.setAttribute('data-dynamic-script', 'true');
                if (script.src) {
                    newScript.src = script.src;
                    newScript.async = false;
                } else {
                    newScript.textContent = script.textContent;
                }
                document.body.appendChild(newScript);
            });

        } catch (error) {
            console.error('é é¢è¼‰å…¥å¤±æ•—:', error);
            contentArea.innerHTML = `<div class="sys-block" style="color: red;">é é¢è¼‰å…¥å¤±æ•—: ${error.message}</div>`;
            // å¤±æ•—æ™‚æ¸…é™¤å¯èƒ½æ®˜ç•™çš„åƒæ•¸
            contentArea.removeAttribute('data-page-params');
        }
    }

    // ã€æ–°å¢ã€‘ä¸»å„€è¡¨æ¿ (é¦–é ) çš„ HTML ç”¢ç”Ÿå‡½å¼
    function getMainDashboardHTML() {
        return `
            <div class="dashboard-content">
                <div class="welcome-section">
                    <h1 class="welcome-title">æ­¡è¿ä¾†åˆ° PixelTribe ç®¡ç†å¾Œå°</h1>
                    <p class="welcome-subtitle">è«‹å¾å·¦å´é¸å–®é¸æ“‡æ‚¨è¦ç®¡ç†çš„ç³»çµ±ã€‚</p>
                </div>
                <div class="stats-grid">
                    <div class="stat-card"><i class="bi bi-people-fill stat-icon"></i><div class="stat-number">1,204</div><div class="stat-label">ç¸½æœƒå“¡æ•¸</div></div>
                    <div class="stat-card"><i class="bi bi-newspaper stat-icon"></i><div class="stat-number">38</div><div class="stat-label">æ–°èç¸½æ•¸</div></div>
                    <div class="stat-card"><i class="bi bi-chat-square-dots-fill stat-icon"></i><div class="stat-number">512</div><div class="stat-label">è«–å£‡æ–‡ç« æ•¸</div></div>
                    <div class="stat-card"><i class="bi bi-shop-window stat-icon"></i><div class="stat-number">156</div><div class="stat-label">ä¸Šæ¶å•†å“æ•¸</div></div>
                </div>
                <div class="guide-text">
                    <h3>ğŸš€ å¿«é€Ÿé–‹å§‹</h3>
                    <p>æ­¤ç®¡ç†å¾Œå°æ•´åˆäº†å¤šå€‹æ ¸å¿ƒç³»çµ±ï¼Œæ‚¨å¯ä»¥ï¼š<br>
                        â€¢ <strong>å•†åŸç³»çµ±</strong>ï¼šç®¡ç†å•†å“ã€è¨‚å–®ã€å„ªæƒ åˆ¸ç­‰é›»å•†åŠŸèƒ½ã€‚<br>
                        â€¢ <strong>æ–°èç³»çµ±</strong>ï¼šç™¼å¸ƒæœ€æ–°å…¬å‘Šã€ç®¡ç†ä½¿ç”¨è€…è©•è«–èˆ‡æª¢èˆ‰ã€‚<br>
                        â€¢ <strong>è«–å£‡ç³»çµ±</strong>ï¼šç¶­è­·è¨è«–å€ç§©åºã€ç®¡ç†æ–‡ç« èˆ‡å®˜æ–¹å…¬å‘Šã€‚<br>
                        â€¢ <strong>æœƒå“¡ç³»çµ±</strong>ï¼šæŸ¥è©¢æœƒå“¡è³‡æ–™ä¸¦åŸ·è¡Œç®¡ç†æ“ä½œã€‚
                    </p>
                </div>
            </div>
        `;
    }

    // å•†åŸå„€è¡¨æ¿çš„ HTML
    function getShopDashboardHTML() {
        // ... æ­¤å‡½å¼å…§å®¹ä¸è®Š ...
        return `
            <div class="dashboard-content">
                <div class="welcome-section">
                    <h1 class="welcome-title">å•†åŸç®¡ç†ä¸­å¿ƒ</h1>
                    <p class="welcome-subtitle">é€™è£¡æ˜¯å•†åŸç³»çµ±çš„æ•¸æ“šç¸½è¦½å„€è¡¨æ¿ã€‚</p>
                </div>
                <div class="stats-grid">
                    <div class="stat-card"><i class="bi bi-box-seam stat-icon"></i><div class="stat-number">156</div><div class="stat-label">å•†å“ç¸½æ•¸</div></div>
                    <div class="stat-card"><i class="bi bi-cart-check stat-icon"></i><div class="stat-number">89</div><div class="stat-label">å¾…è™•ç†è¨‚å–®</div></div>
                    <div class="stat-card"><i class="bi bi-ticket-perforated stat-icon"></i><div class="stat-number">23</div><div class="stat-label">æ´»èºå„ªæƒ åˆ¸</div></div>
                    <div class="stat-card"><i class="bi bi-cash-stack stat-icon"></i><div class="stat-number">$52,680</div><div class="stat-label">æœ¬æœˆç‡Ÿæ”¶</div></div>
                </div>
                <div class="guide-text">
                    <h3>ğŸ“‹ ä½¿ç”¨èªªæ˜</h3>
                    <p>è«‹ä½¿ç”¨å·¦å´é¸å–®é€²è¡Œå„é …ç®¡ç†æ“ä½œã€‚<br>â€¢ <strong>ç”¢å“ç®¡ç†</strong>ï¼šç®¡ç†å•†å“ä¸Šä¸‹æ¶ã€åˆ†é¡å’Œè³‡è¨Šã€‚<br>â€¢ <strong>è¨‚å–®ç®¡ç†</strong>ï¼šè™•ç†è¨‚å–®ã€å‡ºè²¨èˆ‡è©•è«–ã€‚<br>â€¢ <strong>å„ªæƒ åˆ¸ç®¡ç†</strong>ï¼šå»ºç«‹å’Œç®¡ç†å„ªæƒ æ´»å‹•ã€‚</p>
                </div>
            </div>
        `;
    }

    // ä½”ä½é é¢çš„ HTMLï¼Œç”¨æ–¼é¡¯ç¤ºé–‹ç™¼ä¸­çš„é é¢
    function getPlaceholderHTML(pageKey, subKey) {
        // ... æ­¤å‡½å¼å…§å®¹ä¸è®Š ...
        const pageTitles = {
            store: 'å•†åŸç³»çµ±', news: 'æ–°èç³»çµ±', forum: 'è«–å£‡ç³»çµ±', member: 'æœƒå“¡ç³»çµ±'
        };
        const subTitles = {
            'toggle': 'ç”¢å“ä¸Šä¸‹æ¶',
            'categories': 'ç”¢å“åˆ†é¡',
            'edit': 'ç·¨è¼¯ç”¢å“è³‡è¨Š',
            'orders': 'è¨‚å–®ç®¡ç†',
            'shipping': 'ç”¢å“ç™¼è²¨ç®¡ç†',
            'reviews': 'è¨‚å–®è©•è«–ç®¡ç†',
            'coupons': 'å„ªæƒ åˆ¸ç®¡ç†',
            'dashboard': 'å„€è¡¨æ¿', 
            'news-edit': 'æ–°èç·¨è¼¯',
            'comments': 'æ–°èè©•è«–ç®¡ç†',
            'reports': 'å¯©æ ¸æª¢èˆ‰',
            'forums': 'è¨è«–å€ç®¡ç†',
            'posts': 'æ–‡ç« ç®¡ç†',
            'forum-comments': 'ç•™è¨€ç®¡ç†',
            'official': 'ç™¼å¸ƒå®˜æ–¹æ–‡ç« ',
            'categories': 'è¨è«–å€é¡åˆ¥ç®¡ç†',
            'query': 'æœƒå“¡è³‡æ–™æŸ¥è©¢',
            'suspend': 'æœƒå“¡åœæ¬Š'
        };

        const title = pageTitles[pageKey] || 'ç³»çµ±';
        const subTitle = subTitles[subKey] || 'åŠŸèƒ½é é¢';
        const fullTitle = (subKey === 'dashboard') ? `${title}å„€è¡¨æ¿` : subTitle;

        return `
            <div class="sys-block">
                <h2 class="sys-subtitle">${fullTitle}</h2>
                <ul>
                    <li><i class="bi bi-tools item-icon"></i>æ­¤é é¢ç‚º <strong>${fullTitle}</strong> çš„ç®¡ç†ä»‹é¢ã€‚</li>
                    <li><i class="bi bi-gear-wide-connected item-icon"></i>å¾ŒçºŒè«‹åœ¨æ­¤è™•é–‹ç™¼å°æ‡‰åŠŸèƒ½ã€‚</li>
                    <li><i class="bi bi-file-code item-icon"></i>ä½ å¯ä»¥åœ¨é€™è£¡ä½¿ç”¨ fetch API å‘å¾Œç«¯è«‹æ±‚è³‡æ–™ï¼Œä¸¦å‹•æ…‹æ¸²æŸ“è¡¨æ ¼æˆ–è¡¨å–®ã€‚</li>
                </ul>
            </div>
        `;
    }

    function handleLogout() {
        window.location.href = '/back-end/adm/AdmLogin.html';
        localStorage.removeItem('memberInfo');
        localStorage.removeItem('jwt');
    }

    function loadMainDashboard(event) {
        if (event) event.preventDefault();
        document.querySelectorAll('.menu-item.active').forEach(item => item.classList.remove('active'));
        document.querySelectorAll('.submenu-item.active').forEach(item => item.classList.remove('active'));
        contentArea.innerHTML = getMainDashboardHTML();
    }

    window.onload = function () {
        loadMainDashboard();
    }
</script>
</body>
</html>